{"swagger":"2.0","info":{"version":"0.0.1","title":"dgx-patron-creator-service"},"host":"localhost:3001","schemes":["https"],"consumes":["application/json"],"produces":["application/json"],"paths":{"/v0.1/patrons":{"x-swagger-router-controller":"patrons","post":{"tags":["patrons"],"summary":"Create a Patron","description":"Create a new patron account against NYPL's Simplified Card Creator.","operationId":"patrons_creator","parameters":[{"name":"patron_data","in":"body","description":"The information of the new patron","required":true,"schema":{"$ref":"#/definitions/PatronsCreatorData"}}],"responses":{"200":{"description":"Successful operation","schema":{"$ref":"#/definitions/PatronsCreatorResponse"}},"400":{"description":"Bad request","schema":{"$ref":"#/definitions/400ErrorResponse"}},"500":{"description":"Generic server error","schema":{"$ref":"#/definitions/500ErrorResponse"}}},"security":[{"api_auth":["openid offline_access api"]}]}}},"definitions":{"PatronsCreatorData":{"required":["simplePatron"],"properties":{"simplePatron":{"$ref":"#/definitions/SimplePatron"}}},"SimplePatron":{"required":["name","dateOfBirth","address","username","pin","policy_type"],"properties":{"name":{"type":"string","example":"Mikey Olson, Jr."},"dateOfBirth":{"type":"string","example":"11/11/1987"},"email":{"type":"string","example":"mjolson@example.com"},"address":{"$ref":"#/definitions/AddressModel"},"username":{"type":"string","example":"mjolson54321"},"pin":{"type":"string","example":"1234"},"work_or_school_address":{"$ref":"#/definitions/AddressModel"},"policy_type":{"type":"string","example":"web_applicant"}}},"PatronsCreatorResponse":{"type":"object","required":["data"],"properties":{"data":{"$ref":"#/definitions/PatronsCreatorResponseModel"}}},"PatronsCreatorResponseModel":{"required":["status_code_from_card_creator","simplePatron","message","detail","count"],"properties":{"status_code_from_card_creator":{"type":"number","example":200},"patron":{"type":"object","example":{}},"simplePatron":{"$ref":"#/definitions/SimplePatronModel"},"message":{"type":"string","example":"Your library card is temporary because your address could not be verified. Visit your local NYPL branch within 30 days to upgrade to a standard card."},"detail":{"type":"object","example":{}},"count":{"type":"number","example":1}}},"SimplePatronModel":{"required":["type","username","temporary"],"properties":{"type":{"type":"string","example":"card-granted"},"username":{"type":"string","example":"mikeolson54321"},"temporary":{"type":"boolean","example":true}}},"AddressModel":{"type":"object","required":["line_1","city","state","zip"],"properties":{"line_1":{"type":"string","example":"123 Fake Street"},"line_2":{"type":"string","example":""},"city":{"type":"string","example":"New York"},"state":{"type":"string","example":"NY"},"zip":{"type":"string","example":10018}}},"400ErrorResponse":{"required":["data"],"properties":{"data":{"$ref":"#/definitions/400ErrorResponseContent"}}},"400ErrorResponseContent":{"allOf":[{"$ref":"#/definitions/400ErrorStatusModel"},{"$ref":"#/definitions/ErrorModel"}]},"500ErrorResponse":{"required":["data"],"properties":{"data":{"$ref":"#/definitions/500ErrorResponseContent"}}},"500ErrorResponseContent":{"allOf":[{"$ref":"#/definitions/500ErrorStatusModel"},{"$ref":"#/definitions/ErrorModel"}]},"400ErrorStatusModel":{"required":["status_code_from_card_creator","type","message"],"properties":{"status_code_from_card_creator":{"type":"number","example":400},"type":{"type":"string","example":"invalid-request"},"message":{"type":"string","example":"No data"}}},"500ErrorStatusModel":{"required":["status_code_from_card_creator","type","message"],"properties":{"status_code_from_card_creator":{"type":"number","example":500},"type":{"type":"string","example":"internal-server-error"},"message":{"type":"string","example":"Internal server error"}}},"ErrorModel":{"required":["patron","simplePatron","detail","count"],"properties":{"patron":{"type":"object"},"simplePatron":{"type":"object"},"detail":{"type":"object","example":{"title":"Not found.","debug":"Invalid endpoint: [POST] /v2/patrons"}},"count":{"type":"number","example":0}}}},"tags":[{"name":"patrons","description":"Patron API"}],"securityDefinitions":{"api_auth":{"type":"oauth2","flow":"accessCode","authorizationUrl":"https://isso.nypl.org/oauth/authorize","tokenUrl":"https://isso.nypl.org/oauth/token","scopes":{"openid offline_access api":"General API access"}}}}
